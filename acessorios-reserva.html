<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Acessórios - Atlética Tormenta</title>
    <link rel="icon" type="image/png" href="favicon.png">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Oswald:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <link rel="stylesheet" href="style.css"> 
</head>
<body>
    <div class="container form-container">
        <h1>Acessórios</h1>
        <p>Preencha o formulário abaixo para comprar seus acessórios. Entraremos em contato em breve para combinar a entrega.</p>

        <form id="formAcessorios" method="POST">
            
            <div class="form-group">
                <label for="nome">Nome Completo:</label>
                <input type="text" id="nome" name="Nome Completo" required>
            </div>
            
            <div class="form-group">
                <label for="acessorio">Nome do Acessório:</label>
                <input type="text" id="acessorio" name="Nome do Acessório" placeholder="Exemplo: Tirante, caneca, boné" required>
            </div>
            
            <div class="form-group">
                <label for="quantidade">Quantidade:</label>
                <input type="number" id="quantidade" name="Quantidade" min="1" required>
            </div>

            <div class="form-group">
                <label for="contato">Número para contato (WhatsApp):</label>
                <input type="tel" id="contato" name="Número para contato" required placeholder="(XX) 9XXXX-XXXX">
            </div>

            <div class="form-group"> 
                <label>Pagamento PIX:</label>
                <div style="border: 1px solid #7a7a7a; padding: 10px; background-color: #383838; border-radius: 5px; margin-top: 5px;">
                    <p style="font-size: 1.1em; font-weight: bold; color: yellow; margin-top: 0; margin-bottom: 5px;">
                        Chave PIX:
                    </p>
                    <input type="text" id="pixKeyInput" value="(79) 98869-0849" readonly 
                            style="width: 100%; padding: 8px; background: #2a2a2a; color: white; border: none; cursor: pointer; font-size: 1em; box-sizing: border-box; text-align: center;"
                            aria-label="Chave PIX para cópia">
                    <small id="pixCopyStatus" style="color: #ccc; display: block; margin-top: 5px; text-align: center;">
                        Clique na chave PIX acima para copiar.
                    </small>
                </div>
            </div>

            <div class="form-group">
                <label>Instrução do Comprovante:</label>
                <div style="border: 1px solid #7a7a7a; padding: 10px; background-color: #383838; border-radius: 5px; margin-top: 5px;">
                    <p style="margin-top: 0; color: #f0f0f0;">
                        Após o pagamento via PIX, por favor, envie o comprovante para o e-mail: 
                        <strong style="color: yellow;">tormenta.ufpe@gmail.com</strong>, mencionando seu nome completo.
                    </p>
                </div>
            </div>
            <button type="submit" id="submitButton" class="submit-button">Enviar</button>
        </form>
        
        <p id="statusMessage" style="margin-top: 20px; font-weight: bold;"></p>
    </div>
    
    <a href="escolha.html" class="floating-back-button" aria-label="Voltar à tela de escolha">
        <i class="fas fa-arrow-left"></i>
    </a>

    <script>
        
       
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyS8IEUWvGwtLcxvyrfX3o_HnI6Knt-0ZXvEwq9TMCroou4CNyc_8R3YhsVcu9VT5V65A/exec"; 
        
        const MAX_FILE_SIZE_MB = 5; 

        document.addEventListener('DOMContentLoaded', () => {
            
            const form = document.getElementById('formAcessorios');
            const submitButton = document.getElementById('submitButton');
            const statusMessage = document.getElementById('statusMessage');
            // const comprovanteInput = document.getElementById('comprovante'); 
            const pixKeyInput = document.getElementById('pixKeyInput');
            const pixCopyStatus = document.getElementById('pixCopyStatus');
            
            const navBar = document.querySelector('header');
            const navHeight = navBar ? navBar.offsetHeight : 0;
            let prevScrollpos = window.pageYOffset;

            
            function setStatus(message, isError = false) {
                statusMessage.textContent = message;
                statusMessage.style.color = isError ? 'red' : 'green';
            }
            
            
            pixKeyInput.addEventListener('click', () => {
                navigator.clipboard.writeText(pixKeyInput.value)
                    .then(() => {
                        const originalText = pixCopyStatus.textContent;
                        pixCopyStatus.textContent = "✅ Chave PIX copiada!";
                        setTimeout(() => {
                            pixCopyStatus.textContent = originalText;
                        }, 2000);
                    })
                    .catch(err => {
                        console.error('Erro ao copiar texto: ', err);
                        alert('Não foi possível copiar a chave PIX. Tente selecionar o texto manualmente.');
                    });
            });

            
            form.addEventListener('submit', async (e) => {
                e.preventDefault(); 

                setStatus("Enviando... Por favor, não feche a página.", false);
                submitButton.disabled = true;
                submitButton.textContent = "Aguarde...";


                try {
                    const formData = new FormData(form);

                    const response = await fetch(SCRIPT_URL, {
                        method: 'POST',
                        body: formData 
                    });

                    if (response.ok) {
                        const result = await response.json(); 
                        
                        if (result.result === 'success') {
                            setStatus('✅ Sucesso! Seu pedido foi recebido. Lembre-se de enviar o comprovante por email!', false);
                            form.reset(); 
                        } else {
                            setStatus(`❌ Erro no servidor: ${result.message || 'Falha ao processar.'}`, true);
                        }
                    } else {
                        // Este bloco deve resolver o erro 405 se a URL estiver correta!
                        setStatus('❌ Erro de conexão. Verifique sua URL ou a implantação.', true);
                    }

                } catch (error) {
                    console.error('Erro de envio:', error);
                    setStatus('❌ Falha crítica ao enviar. Verifique sua conexão.', true);
                } finally {
                    
                    submitButton.disabled = false; 
                    submitButton.textContent = "Enviar Pedido";
                }
            });

            
            window.onscroll = function() {
                if (!navBar) return; 

                let currentScrollPos = window.pageYOffset;
                if (window.innerWidth > 768) {
                    if (prevScrollpos > currentScrollPos) {
                        navBar.style.top = "0";
                    } else {
                        navBar.style.top = `-${navHeight}px`;
                    }
                } else {
                    navBar.style.top = "0";
                }
                prevScrollpos = currentScrollPos;
            }
        });
    </script>
</body>
</html>
